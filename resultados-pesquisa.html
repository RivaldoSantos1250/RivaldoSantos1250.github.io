<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="assets/styles/header.css">
    <title>Resultados da Pesquisa</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
            color: #333;
        }

        h1 {
            text-align: center;
            margin-top: 20px;
        }

        #search-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
            opacity: 0; /* Inicia com opacidade 0 */
            transition: opacity 0.5s ease; /* Adiciona uma transição suave */
        }

        .recipe {
            background-color: #fff;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease; /* Adiciona uma transição suave */
            cursor: pointer;
            position: relative;
        }

        .recipe:hover {
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            transform: translateY(-5px); /* Levanta um pouco ao passar o mouse */
        }

        .recipe img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .recipe-info {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 10px 20px;
        }

        .recipe-title {
            margin: 0;
            font-size: 20px;
            font-weight: bold; /* Adiciona negrito ao título da receita */
        }

        .recipe-title a {
            color: #333;
            text-decoration: none;
        }

        .recipe-title a:hover {
            color: #ffcc00;
        }

        .recipe-description {
            margin: 0;
            font-size: 16px;
            color: #666; /* Altera a cor do texto da descrição da receita */
        }

        /* Animação de fade-in para os resultados */
        #search-results.fade-in {
            opacity: 1;
        }

        
    </style>
</head>
<body>

    <header>
        <div class="logo">
            <h1>TiaNaCozinha</h1>
        </div>
        
        <nav>
            <ul id="main-nav">
                <li><a href="#">Home</a></li>
                <li><a href="#">Receitas</a></li>
                <li><a href="#">Contato</a></li>
            </ul>
            <div class="search-container">
                <form class="search-form" action="resultados-pesquisa.html" method="GET">
                    <input class="search-input" type="text" name="q" placeholder="Pesquisar...">
                    <button class="search-button" type="submit">Pesquisar</button>
                </form>
            </div>
            
        </nav>
        <div class="mobile-search-icon" onclick="toggleSearch()">
            <i class="fas fa-search"></i>
        </div>
        <div class="menu-icon" onclick="toggleMenu()">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
        </div>
    </header>

    <div class="mobile-menu" id="mobile-menu">
        <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">Receitas</a></li>
            <li><a href="#">Contato</a></li>
        </ul>
    </div>

    <h1>Resultados da Pesquisa</h1>
    
    <div id="search-results"></div>

    <script src="assets/javascript/script.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var params = new URLSearchParams(window.location.search);
            var query = params.get('q');

            if (query !== null && query !== '') {
                searchRecipes(query);
            } else {
                displayNoResults();
            }
        });

       // Função para calcular a distância de edição (Levenshtein Distance) entre duas strings
function levenshteinDistance(a, b) {
    if (a.length === 0) return b.length;
    if (b.length === 0) return a.length;

    var matrix = [];

    // Inicialização da matriz
    var i;
    for (i = 0; i <= b.length; i++) {
        matrix[i] = [i];
    }

    for (i = 0; i <= a.length; i++) {
        matrix[0][i] = i;
    }

    // Cálculo da distância de edição
    for (i = 1; i <= b.length; i++) {
        for (var j = 1; j <= a.length; j++) {
            if (b.charAt(i - 1) == a.charAt(j - 1)) {
                matrix[i][j] = matrix[i - 1][j - 1];
            } else {
                matrix[i][j] = Math.min(matrix[i - 1][j - 1] + 1, // Substituição
                    Math.min(matrix[i][j - 1] + 1, // Inserção
                        matrix[i - 1][j] + 1)); // Deleção
            }
        }
    }

    return matrix[b.length][a.length];
}

// Função para verificar se a consulta está associada a uma palavra-chave doce
function isAssociatedWithSweet(queryLower, recipeNameLower) {
    // Lista de palavras-chave associadas a receitas doces
    var sweetKeywords = ["sobremesa", "guloseima", "doce", "sobremesas", "guloseimas", "doces"];

    // Verifica se a consulta ou o nome da receita contém palavras-chave associadas a receitas doces
    return sweetKeywords.some(function(keyword) {
        return queryLower.includes(keyword) || recipeNameLower.includes(keyword);
    });
}

// Função para pesquisar receitas
function searchRecipes(query) {
    // Conjunto de dados de exemplo das receitas
    var recipes = [
        { nome: "Pudim de Leite Condensado", descricao: "Receita deliciosa de pudim de leite condensado.", imagem: "/assets/img/pudim.jpg", link: "assets/pages/pudim.html" },
        //{ nome: "Bolo de Chocolate", descricao: "Um bolo delicioso e fofinho de chocolate.", imagem: "bolo.jpg", link: "bolo.html" },
        //{ nome: "Torta de Maçã", descricao: "Uma torta deliciosa recheada com maçãs frescas.", imagem: "torta.jpg", link: "torta.html" },
        //{ nome: "Pudim de Caramelo Salgado", descricao: "Uma versão deliciosa do pudim clássico com um toque de caramelo salgado.", imagem: "pudim-salgado.jpg", link: "pudim-salgado.html" },
    ];

    // Converta a consulta de pesquisa e o nome de todas as receitas para minúsculas
    var queryLower = query.toLowerCase();

    // Filtra as receitas que correspondem à consulta
    var results = recipes.filter(function(recipe) {
        // Converta o nome e a descrição da receita para minúsculas
        var recipeNameLower = recipe.nome.toLowerCase();
        var recipeDescriptionLower = recipe.descricao.toLowerCase();

        // Verifique se o nome ou a descrição da receita contém a consulta de pesquisa
        return recipeNameLower.includes(queryLower) || recipeDescriptionLower.includes(queryLower) || isAssociatedWithSweet(queryLower, recipeNameLower);
        // Além de verificar se o nome ou descrição contém a consulta, também verificamos se a consulta está associada a uma palavra-chave doce.
    });

    // Exiba os resultados na página
    displayResults(results);
}

// Função para exibir os resultados da pesquisa
function displayResults(results) {
    var resultsContainer = document.getElementById('search-results');
    resultsContainer.innerHTML = ''; // Limpa os resultados anteriores

    if (results.length > 0) {
        results.forEach(function(recipe) {
            var recipeHTML = '<div class="recipe">';
            recipeHTML += '<a href="' + recipe.link + '">';
            recipeHTML += '<img src="' + recipe.imagem + '" alt="' + recipe.nome + '">';
            recipeHTML += '<div class="recipe-info">';
            recipeHTML += '<h3 class="recipe-title">' + recipe.nome + '</h3>';
            recipeHTML += '<p class="recipe-description">' + recipe.descricao + '</p>';
            recipeHTML += '</div></a></div>';
            resultsContainer.innerHTML += recipeHTML;
        });

        // Adiciona a classe de animação para fade-in dos resultados
        resultsContainer.classList.add('fade-in');
    } else {
        displayNoResults();
    }
}

function displayNoResults() {
    var resultsContainer = document.getElementById('search-results');
    resultsContainer.innerHTML = '<p>Nenhum resultado encontrado.</p>';
    // Adiciona a classe de animação para fade-in dos resultados
    resultsContainer.classList.add('fade-in');
}
    </script>

</body>
</html>
